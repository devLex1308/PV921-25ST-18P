

async function sleep(seconds) {
  return new Promise(r => {
    setTimeout(r, 1000 * seconds);
  });
}


function wraper(fun) {

  const results = new Map();

  return async function(...arg) {
    console.log("Старт функції з аргументами", arg);

    const stringKeys = arg.join("|");

    if (results.has(stringKeys)) {
      return results.get(stringKeys);
    }

    const res = await fun.call({var: 10}, ...arg);

    results.set(stringKeys, res);

    console.log("Фініш функції результат", res);
    return res;
  }
}


const map = new Map();

const key = `
01234567890123456789012345678901234567890123456789
01234567890123456789012345678901234567890123456789
01234567890123456789012345678901234567890123456789
01234567890123456789012345678901234567890123456789
01234567890123456789012345678901234567890123456789
01234567890123456789012345678901234567890123456789
01234567890123456789012345678901234567890123456789
01234567890123456789012345678901234567890123456789
01234567890123456789012345678901234567890123456789
01234567890123456789012345678901234567890123456789
01234567890123456789012345678901234567890123456789
01234567890123456789012345678901234567890123456789
01234567890123456789012345678901234567890123456789
01234567890123456789012345678901234567890123456789
01234567890123456789012345678901234567890123456789
01234567890123456789012345678901234567890123456789
01234567890123456789012345678901234567890123456789
01234567890123456789012345678901234567890123456789
01234567890123456789012345678901234567890123456789
01234567890123456789012345678901234567890123456789
01234567890123456789012345678901234567890123456789
`;

map.set(key, 7);


const someObj = {
  var: 25,
  hardCode: async function (x) {
    await sleep(3);
    console.log({x, f: this});
    return x**2 - this.var;
  }
}


async function hardCode(x, y) {
  console.log(1);
  await sleep(3);
  console.log(2);
  return x**2 - 25 + y**3;
}

const hardCodeWrap = wraper(hardCode);
const objHardCodeWrap = wraper(someObj.hardCode);


async function run() {

  const r = await objHardCodeWrap(10);
  console.log({r});
  const r1 = await hardCodeWrap(5, 9);
  console.log({r1});
  const r2 = await hardCodeWrap(5, 9);
  console.log({r2});
  const r3 = await hardCodeWrap(5, 9);
  console.log({r3});
}

run();